name: clippy

on:
  pull_request:
  push:
    branches:
      - master

env:
  RUSTFLAGS: -Dwarnings

jobs:
  cargo_clippy:
    name: Check
    runs-on: windows-2019
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Update toolchain
        run: rustup update --no-self-update nightly && rustup default nightly-x86_64-pc-windows-msvc
      - name: Install clippy
        run: rustup component add clippy
      - name: Configure environment
        shell: pwsh
        run: |
          "C:\Program Files (x86)\Windows Kits\10\bin\10.0.22000.0\x64" >> $env:GITHUB_PATH
          ((Resolve-Path "C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\VC\Tools\MSVC\*\bin\Hostx64\x64")
            | Sort-Object -Descending | Select -First 1).ToString() >> $env:GITHUB_PATH
          (Join-Path $env:GITHUB_WORKSPACE "target\debug\deps").ToString() >> $env:GITHUB_PATH
          (Join-Path $env:GITHUB_WORKSPACE "target\test\debug\deps").ToString() >> $env:GITHUB_PATH
          "INCLUDE=C:\Program Files (x86)\Windows Kits\10\include\10.0.22000.0\winrt;C:\Program Files (x86)\Windows Kits\10\include\10.0.22000.0\cppwinrt" `
            >> $env:GITHUB_ENV
      - name: Run cargo clippy
        run: |
          cargo clippy -p sample_bits -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_com_uri -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_consent -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_core_app -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_counter -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_counter_sys -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_create_window -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_create_window_sys -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_data_protection -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_dcomp -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_device_watcher -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_direct2d -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_direct3d12 -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_enum_windows -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_enum_windows_sys -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_kernel_event -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_memory_buffer -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_message_box -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_message_box_sys -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_ocr -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_overlapped -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_rss -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_simple -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_spellchecker -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_thread_pool_work -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_thread_pool_work_sys -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_uiautomation -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_wmi -- -A clippy::uninlined_format_args &&
          cargo clippy -p sample_xml -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_agile -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_agile_reference -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_alternate_success_code -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_arch -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_arch_feature -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_bcrypt -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_bstr -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_calling_convention -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_cfg_generic -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_component -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_component_client -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_const_fields -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_const_ptrs -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_core -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_debug -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_debugger_visualizer_x -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_deprecated -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_dispatch -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_does_not_return -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_enums -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_error -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_event -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_extensions -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_handles -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_helpers -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_implement -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_interface -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_interop -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_lib -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_literals -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_match -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_matrix3x2 -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_metadata -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_msrv -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_no_use -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_not_dll -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_query_signature -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_readme -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_reserved -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_resources -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_return_struct -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_simple_component -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_string_param -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_structs -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_sys -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_unions -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_weak -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_weak_ref -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_win32 -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_win32_arrays -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_window_long -- -A clippy::uninlined_format_args &&
          cargo clippy -p test_winrt -- -A clippy::uninlined_format_args &&
          cargo clippy -p tool_gnu -- -A clippy::uninlined_format_args &&
          cargo clippy -p tool_lib -- -A clippy::uninlined_format_args &&
          cargo clippy -p tool_license -- -A clippy::uninlined_format_args &&
          cargo clippy -p tool_msvc -- -A clippy::uninlined_format_args &&
          cargo clippy -p tool_sys -- -A clippy::uninlined_format_args &&
          cargo clippy -p tool_windows -- -A clippy::uninlined_format_args &&
          cargo clippy -p tool_yml -- -A clippy::uninlined_format_args &&
          cargo clippy -p windows -- -A clippy::uninlined_format_args &&
          cargo clippy -p windows-bindgen -- -A clippy::uninlined_format_args &&
          cargo clippy -p windows-implement -- -A clippy::uninlined_format_args &&
          cargo clippy -p windows-interface -- -A clippy::uninlined_format_args &&
          cargo clippy -p windows-metadata -- -A clippy::uninlined_format_args &&
          cargo clippy -p windows-sys -- -A clippy::uninlined_format_args &&
          cargo clippy -p windows-targets -- -A clippy::uninlined_format_args &&
          cargo clippy -p windows-tokens -- -A clippy::uninlined_format_args &&
          cargo clippy -p windows_aarch64_gnullvm -- -A clippy::uninlined_format_args &&
          cargo clippy -p windows_aarch64_msvc -- -A clippy::uninlined_format_args &&
          cargo clippy -p windows_i686_gnu -- -A clippy::uninlined_format_args &&
          cargo clippy -p windows_i686_msvc -- -A clippy::uninlined_format_args &&
          cargo clippy -p windows_x86_64_gnu -- -A clippy::uninlined_format_args &&
          cargo clippy -p windows_x86_64_gnullvm -- -A clippy::uninlined_format_args &&
          cargo clippy -p windows_x86_64_msvc -- -A clippy::uninlined_format_args