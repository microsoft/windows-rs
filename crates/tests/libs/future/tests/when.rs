// TODO: todo: need specific tests for "when"